<!DOCTYPE html>
<html lang="zh_Hant">
<head>
	<meta charset="utf-8">
	<title>列表</title>
	<style type="text/css"></style>
	<script type="text/javascript">
		function showNode(id){
			var x=document.getElementById(id);
			x.style.display="";
		}
		function hideNode(id){
			var x=document.getElementById(id);
			x.style.display="none";
		}
		function add2sever(){
			var data;
			data={prod:document.getElementById("prod").value
				,price:document.getElementById("price").value}
			var xhr=new XMLHttpRequest();
			xhr.open("POST","add.php");
			xhr.setRequestHeader("Content-Type","application/json;charset=UTF-8");
			xhr.onreadystatechange = function(){//現在也可以用xhr.onload
				if(this.readyState==4 ){
					if(this.status == 201){
						console.log(this.responseText);
						hideNode("edit_form");
						showNode("show_add_btn");
					}else{
						console.log(this.responseText);
						alert('新增失敗');
					}
				}
			};
			xhr.send(JSON.stringify(data));
		}
	</script>
</head>
<body>
	<button id="show_add_btn">加入</button>
	<table id="list"></table>
	<div id="edit_form">
		<input type="hidden" id="ppid">
		請輸入商品:<input type="text" id="prod">
		金額:<input type="text" id="price">
		<button id="add_btn">新增</button>
		<button id="update_btn">儲存編輯</button>
		<button id="cancel_btn">取消</button>
	</div>
	<script type="text/javascript">
		(function(){
			hideNode("edit_form");
			hideNode("update_btn");
			document.getElementById("show_add_btn").addEventListener("click",function(){showNode("edit_form");});
			document.getElementById("cancel_btn").addEventListener("click",function(){hideNode("edit_form");});
			document.getElementById("show_add_btn").addEventListener("click",function(){hideNode("show_add_btn");});
			document.getElementById("cancel_btn").addEventListener("click",function(){showNode("show_add_btn");});
			document.getElementById("add_btn").addEventListener("click",add2sever);
		})();
	</script>
</body>
</html>